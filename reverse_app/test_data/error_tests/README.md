# 逆変換スクリプト エラー検出テスト

このディレクトリには、逆変換スクリプトがエラー（値の欠落、変更、順序変更など）を正しく検出できるかを検証するテストケースが含まれています。

## テストケース一覧

### 08_error_missing_value
**目的**: 値の欠落を検出するテスト

- **条件**: 正常な階層構造のXML（一部の要素が欠落している可能性がある）
- **期待値**: すべての要素が正しく変換されたList要素の並び
- **検証**: 要素の欠落を検出できるか

### 09_error_value_changed
**目的**: 値の変更を検出するテスト

- **条件**: 要素の値が変更されているXML
- **期待値**: 元の値で変換されたList要素
- **検証**: 値の変更を検出できるか

### 10_error_order_changed
**目的**: 順序変更を検出するテスト

- **条件**: 正常な階層構造のXML（複数の要素がある）
- **期待値**: 正しい順序で変換されたList要素の並び
- **検証**: 順序変更を検出できるか

### 11_error_missing_column
**目的**: Column要素の欠落を検出するテスト

- **条件**: 複数Column要素があるXML（一部のColumn要素が欠落している可能性がある）
- **期待値**: すべてのColumn要素が正しく変換されたList要素
- **検証**: Column要素の欠落を検出できるか

### 12_error_column_value_changed
**目的**: Column要素の値変更を検出するテスト

- **条件**: Column要素の値が変更されているXML
- **期待値**: 元の値で変換されたList要素
- **検証**: Column要素の値変更を検出できるか

## テストの実行方法

```bash
cd scripts/reverse/test_data/error_tests
python3 run_error_tests.py
```

## テストケースの構造

各テストケースは以下の構造を持ちます：

```
<test_case_name>/
  ├── input.xml      # エラーを含む逆変換前のXMLファイル（階層構造）
  ├── expected.xml   # 期待される出力XMLファイル（エラーがない場合の正しい出力）
  ├── output.xml     # 実際の出力XMLファイル（テスト実行後に生成）
  └── README.md      # テストケースの説明
```

## 検証方法

エラーテストスクリプトは以下の検証を行います：

1. 逆変換パイプラインを実行
2. 出力XMLファイルを期待値と比較
3. **期待値と実際の出力が一致しない場合**にエラーが検出されたとみなす
4. XMLを正規化して構造的な一致を確認

## エラーテストの考え方

エラーテストでは、以下の考え方に基づいて検証を行います：

- **エラーが検出された場合**: 期待値と実際の出力が一致しない → テスト成功 ✅
- **エラーが検出されなかった場合**: 期待値と実際の出力が一致する → テスト失敗 ❌

これは、エラーテストケースでは、実際にエラーが発生していることを想定しているためです。

## 通常のテストとの違い

- **通常のテスト** (`unit_tests/`): 期待値と実際の出力が一致する場合に成功
- **エラーテスト** (`error_tests/`): 期待値と実際の出力が一致しない場合に成功（エラーが検出された）

## 注意事項

エラーテストケースは、実際にエラーが発生している場合に、そのエラーを検出できるかを検証するものです。
テストが成功する（期待値と実際の出力が一致しない）ことは、エラーが正しく検出されたことを意味します。
