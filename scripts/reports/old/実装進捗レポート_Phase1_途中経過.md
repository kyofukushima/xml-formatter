# Phase 1å®Ÿè£…é€²æ—ãƒ¬ãƒãƒ¼ãƒˆï¼ˆé€”ä¸­çµŒéï¼‰

**å®Ÿè£…æ—¥**: 2025å¹´10æœˆ27æ—¥  
**å®Ÿè£…å†…å®¹**: éšå±¤åˆ¤å®šã®å®Œå…¨çµ±åˆï¼ˆPhase 1ï¼‰  
**çŠ¶æ…‹**: å®Ÿè£…ä¸­ãƒ»æ¤œè¨¼ä¸­

---

## ğŸ“‚ ãƒ•ã‚©ãƒ«ãƒ€æ•´ç†å®Œäº†

### å®Ÿæ–½å†…å®¹
education_scriptãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ•´ç†ã—ã€ä»¥ä¸‹ã®æ§‹é€ ã«å†ç·¨æˆã—ã¾ã—ãŸï¼š

```
education_script/
â”œâ”€â”€ convert_list_unified.py      # ãƒ¡ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ test_input5.xml              # ãƒ¡ã‚¤ãƒ³å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«
â”‚
â”œâ”€â”€ tests/                       # ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆ21ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
â”‚   â”œâ”€â”€ test_phase05_integration.py
â”‚   â”œâ”€â”€ test_phase1_hierarchy.py
â”‚   â”œâ”€â”€ test_phase1_debug.py
â”‚   â””â”€â”€ ãã®ä»–ã®ãƒ†ã‚¹ãƒˆ
â”‚
â”œâ”€â”€ test_data/                   # ãƒ†ã‚¹ãƒˆç”¨XMLãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ27ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
â”‚   â”œâ”€â”€ test_output5.xml
â”‚   â””â”€â”€ test_output5_phase*.xml
â”‚
â”œâ”€â”€ reports/                     # ãƒ¬ãƒãƒ¼ãƒˆãƒ»åˆ†æçµæœï¼ˆ18ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
â”‚   â”œâ”€â”€ å®Ÿè£…é€²æ—ãƒ¬ãƒãƒ¼ãƒˆ_Phase05.md
â”‚   â””â”€â”€ å„ç¨®ãƒ¬ãƒãƒ¼ãƒˆ
â”‚
â”œâ”€â”€ docs/                        # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆ4ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
â”‚   â”œâ”€â”€ ä¿®æ­£ãƒ­ã‚¸ãƒƒã‚¯åˆ†æ.md
â”‚   â”œâ”€â”€ å®Ÿè£…æˆ¦ç•¥åˆ†æ.md
â”‚   â””â”€â”€ å®Ÿè£…çŠ¶æ³åˆ†æ.md
â”‚
â””â”€â”€ archive/                     # å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆ4ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
```

**æˆæœ**: 
- ãƒ•ã‚¡ã‚¤ãƒ«æ•°ã‚’æ•´ç†ã—ã€å¯èª­æ€§ãŒå¤§å¹…ã«å‘ä¸Š
- ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¯`tests/`ã«é›†ç´„
- éå»ã®XMLå‡ºåŠ›ã¯`test_data/`ã«é›†ç´„
- ãƒ¬ãƒãƒ¼ãƒˆã¯`reports/`ã«é›†ç´„

---

## ğŸ”§ Phase 1å®Ÿè£…å†…å®¹

### å®Ÿè£…ç›®æ¨™
`determine_element_type()`ã‚’ä½¿ç”¨ã—ã¦ã€è¦ªè¦ç´ ã«å¿œã˜ãŸæ­£ã—ã„éšå±¤æ§‹é€ ã‚’æ§‹ç¯‰

### å®Ÿè£…ã—ãŸæ©Ÿèƒ½

#### 1. éšå±¤ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®è¿½è·¡ï¼ˆ839-851è¡Œç›®ï¼‰

```python
# â˜… Phase 1: éšå±¤ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®è¿½è·¡
hierarchy_context = {
    'current_parent': None,      # ç¾åœ¨ã®è¦ªè¦ç´ 
    'parent_tag': 'Paragraph',   # è¦ªè¦ç´ ã®ã‚¿ã‚°å
    'counters': {                # å„éšå±¤ã®ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼
        'Item': 0,
        'Subitem1': 0,
        'Subitem2': 0,
        'Subitem3': 0,
        'Subitem4': 0,
        'Subitem5': 0,
    }
}
```

**æ©Ÿèƒ½**: ç¾åœ¨ã®è¦ªè¦ç´ ã¨å„éšå±¤ã®ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’ç®¡ç†

---

#### 2. Columnæ§‹é€ ã®éšå±¤åˆ¤å®šï¼ˆ926-1054è¡Œç›®ï¼‰

**æ©Ÿèƒ½**: Columnæ§‹é€ ãŒã‚ã‚‹å ´åˆã€éšå±¤ãƒ¬ãƒ™ãƒ«ã‚’åˆ¤å®šã—ã¦é©åˆ‡ãªè¦ç´ ã‚’ä½œæˆ

**å®Ÿè£…å†…å®¹**:
```python
# éšå±¤ãƒ¬ãƒ™ãƒ«ã‚’åˆ¤å®š
level = self.get_hierarchy_level(label)

# determine_element_type()ã§è¦ç´ ã‚¿ã‚¤ãƒ—ã‚’æ±ºå®š
element_type = self.determine_element_type(hierarchy_context['parent_tag'], label)

# è¦ç´ ã‚’ä½œæˆã—ã€é©åˆ‡ãªè¦ªè¦ç´ ã«è¿½åŠ 
if element_type == 'Item':
    # Itemã‚’ä½œæˆã—ã€Paragraphç›´ä¸‹ã«é…ç½®
    ...
elif element_type.startswith('Subitem'):
    # Subitemã‚’ä½œæˆã—ã€è¦ªè¦ç´ ã®ä¸‹ã«é…ç½®
    ...
```

---

#### 3. æ±ç”¨Subitemè¦ç´ ä½œæˆé–¢æ•°ï¼ˆ577-613è¡Œç›®ï¼‰

```python
def create_subitem_element(self, element_type: str, title: str, 
                          content_elem: Optional[ET.Element], num: int) -> ET.Element:
    """æ±ç”¨Subitemè¦ç´ ä½œæˆï¼ˆPhase 1å®Ÿè£…ï¼‰
    
    Args:
        element_type: 'Subitem1', 'Subitem2', 'Subitem3', etc.
        title: ã‚¿ã‚¤ãƒˆãƒ«ãƒ†ã‚­ã‚¹ãƒˆ
        content_elem: ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¦ç´ ï¼ˆSentenceã¾ãŸã¯Noneï¼‰
        num: è¦ç´ ç•ªå·
    
    Returns:
        ET.Element: ä½œæˆã•ã‚ŒãŸSubitemè¦ç´ 
    """
    # è¦ç´ ã‚’ä½œæˆ
    subitem = ET.Element(element_type, attrib={'Num': str(num)})
    
    # Titleã‚’è¿½åŠ 
    title_tag = f'{element_type}Title'
    subitem_title = ET.SubElement(subitem, title_tag)
    subitem_title.text = title
    
    # Sentenceã‚’è¿½åŠ 
    sentence_tag = f'{element_type}Sentence'
    subitem_sentence = ET.SubElement(subitem, sentence_tag)
    ...
    
    return subitem
```

**æ©Ÿèƒ½**: ä»»æ„ã®Subitemãƒ¬ãƒ™ãƒ«ï¼ˆ1-10ï¼‰ã®è¦ç´ ã‚’ä½œæˆã§ãã‚‹æ±ç”¨é–¢æ•°

---

### ä½œæˆã—ãŸãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ

#### 1. `tests/test_phase1_hierarchy.py`
**ç›®çš„**: éšå±¤æ§‹é€ ãŒæ­£ã—ãæ§‹ç¯‰ã•ã‚Œã‚‹ã‹ã‚’æ¤œè¨¼

**ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹**:
```xml
å…¥åŠ›:
  ï¼ˆï¼‘ï¼‰ç¬¬ä¸€é …ç›®
  ã‚¢  å­é …ç›®A
  ã‚¤  å­é …ç›®B
  ï¼ˆï¼’ï¼‰ç¬¬äºŒé …ç›®
  ã‚¦  å­é …ç›®C

æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
  Item[1]: ã€Œï¼ˆï¼‘ï¼‰ã€
    â””â”€ Subitem1[1]: ã€Œã‚¢ã€
    â””â”€ Subitem1[2]: ã€Œã‚¤ã€
  Item[2]: ã€Œï¼ˆï¼’ï¼‰ã€
    â””â”€ Subitem1[1]: ã€Œã‚¦ã€
```

#### 2. `tests/test_phase1_debug.py`
**ç›®çš„**: `determine_element_type()`ã®å‹•ä½œã‚’ç¢ºèª

---

## âš ï¸ ç¾åœ¨ã®å•é¡Œ

### å•é¡Œ1: éšå±¤æ§‹é€ ãŒæ§‹ç¯‰ã•ã‚Œãªã„

**ç—‡çŠ¶**:
```
å®Ÿéš›ã®å‡ºåŠ›:
  Item[1]: ã€Œï¼ˆï¼‘ï¼‰ã€  â† æ­£ã—ã„
  Item[2]: ã€Œã‚¢ã€      â† èª¤ã‚Šï¼ˆSubitem1ã§ã‚ã‚‹ã¹ãï¼‰
  Item[3]: ã€Œã‚¤ã€      â† èª¤ã‚Šï¼ˆSubitem1ã§ã‚ã‚‹ã¹ãï¼‰
  Item[4]: ã€Œï¼ˆï¼’ï¼‰ã€  â† æ­£ã—ã„
  Item[5]: ã€Œã‚¦ã€      â† èª¤ã‚Šï¼ˆSubitem1ã§ã‚ã‚‹ã¹ãï¼‰
```

**åŸå› ï¼ˆæ¨æ¸¬ï¼‰**:
1. `determine_element_type()`ãŒå¸¸ã«'Item'ã‚’è¿”ã—ã¦ã„ã‚‹å¯èƒ½æ€§
2. è¦ªè¦ç´ ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆï¼ˆ`hierarchy_context['parent_tag']`ï¼‰ãŒæ­£ã—ãæ›´æ–°ã•ã‚Œã¦ã„ãªã„
3. éšå±¤ãƒ¬ãƒ™ãƒ«ã®åˆ¤å®šã«å•é¡ŒãŒã‚ã‚‹

**ãƒ‡ãƒãƒƒã‚°æ–¹æ³•**:
- `tests/test_phase1_debug.py`ã‚’å®Ÿè¡Œã—ã¦`determine_element_type()`ã®å‹•ä½œã‚’ç¢ºèª
- å¿…è¦ã«å¿œã˜ã¦ã€`convert_list_unified.py`å†…ã«ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã‚’è¿½åŠ 

---

## ğŸ“Š å®Ÿè£…é€²æ—

| ãƒ•ã‚§ãƒ¼ã‚º | æ©Ÿèƒ½ | å®Ÿè£…çŠ¶æ³ | å¯¾å¿œæ•° | çŠ¶æ…‹ |
|---------|------|---------|--------|------|
| Phase 0 | Articleåˆ†å‰² | âœ… å®Œäº† | 1å€‹ | âœ… å‹•ä½œç¢ºèªæ¸ˆã¿ |
| Phase 0.5 | ãƒ©ãƒ™ãƒ«åˆ†é›¢ | âœ… å®Œäº† | åŸºç›¤æ©Ÿèƒ½ | âœ… å‹•ä½œç¢ºèªæ¸ˆã¿ |
| **Phase 1** | **éšå±¤åˆ¤å®šå®Œå…¨ç‰ˆ** | **ğŸ”„ å®Ÿè£…ä¸­** | **-** | **âš ï¸ æ¤œè¨¼ä¸­** |
| Phase 2 | è¤‡é›‘ãƒ‘ã‚¿ãƒ¼ãƒ³ | â³ æœªå®Ÿè£… | 44å€‹ | - |
| Phase 3 | è§’æ‹¬å¼§ç§‘ç›®å | â³ éƒ¨åˆ†å®Ÿè£… | 14å€‹ | - |

**å®Ÿè£…é€²æ—**: **ç´„55%** ï¼ˆPhase 0, 0.5å®Œäº†ã€Phase 1å®Ÿè£…ä¸­ï¼‰

---

## ğŸ” æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### å³åº§ã®å¯¾å¿œ
1. **ãƒ‡ãƒãƒƒã‚°å®Ÿè¡Œ**: `tests/test_phase1_debug.py`ã‚’å®Ÿè¡Œ
2. **å•é¡Œã®ç‰¹å®š**: `determine_element_type()`ã®å‹•ä½œã‚’ç¢ºèª
3. **ä¿®æ­£**: è¦ªè¦ç´ ã®è¿½è·¡ãƒ­ã‚¸ãƒƒã‚¯ã‚’ä¿®æ­£
4. **å†ãƒ†ã‚¹ãƒˆ**: `tests/test_phase1_hierarchy.py`ã§æ¤œè¨¼

### Phase 1å®Œäº†å¾Œ
5. **çµ±åˆãƒ†ã‚¹ãƒˆ**: `test_input5.xml`ã§å‹•ä½œç¢ºèª
6. **ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ**: Phase 1å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ
7. **Phase 2ã¸ã®ç§»è¡Œ**: è¤‡é›‘ãƒ‘ã‚¿ãƒ¼ãƒ³å‡¦ç†ã®å®Ÿè£…

---

## ğŸ“ å®Ÿè£…ã®è©³ç´°

### ã‚³ãƒ¼ãƒ‰å¤‰æ›´ç®‡æ‰€

| ãƒ•ã‚¡ã‚¤ãƒ« | è¡Œç¯„å›² | å†…å®¹ |
|---------|--------|------|
| `convert_list_unified.py` | 577-613 | `create_subitem_element()`è¿½åŠ  |
| `convert_list_unified.py` | 839-851 | éšå±¤ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®åˆæœŸåŒ– |
| `convert_list_unified.py` | 926-1054 | Columnæ§‹é€ ã®éšå±¤åˆ¤å®šå‡¦ç† |
| `convert_list_unified.py` | 1056 | ãƒ‘ã‚¿ãƒ¼ãƒ³Bå‰Šé™¤ï¼ˆçµ±åˆæ¸ˆã¿ï¼‰ |

### æ–°è¦ä½œæˆãƒ•ã‚¡ã‚¤ãƒ«

| ãƒ•ã‚¡ã‚¤ãƒ« | ç›®çš„ |
|---------|------|
| `FOLDER_STRUCTURE.md` | ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ |
| `tests/test_phase1_hierarchy.py` | Phase 1éšå±¤åˆ¤å®šãƒ†ã‚¹ãƒˆ |
| `tests/test_phase1_debug.py` | ãƒ‡ãƒãƒƒã‚°ç”¨ãƒ†ã‚¹ãƒˆ |
| `reports/å®Ÿè£…é€²æ—ãƒ¬ãƒãƒ¼ãƒˆ_Phase1_é€”ä¸­çµŒé.md` | æœ¬ãƒ¬ãƒãƒ¼ãƒˆ |

---

## âœ… å®Œäº†ã—ãŸä½œæ¥­

1. âœ… ãƒ•ã‚©ãƒ«ãƒ€æ•´ç†ï¼ˆtests/, test_data/, reports/, docs/, archive/ï¼‰
2. âœ… `create_subitem_element()`æ±ç”¨é–¢æ•°ã®å®Ÿè£…
3. âœ… éšå±¤ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®è¿½è·¡æ©Ÿèƒ½ã®å®Ÿè£…
4. âœ… `determine_element_type()`çµ±åˆï¼ˆColumnæ§‹é€ ï¼‰
5. âœ… ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä½œæˆ

---

## â³ æ®‹ä½œæ¥­

1. â³ Phase 1ã®ãƒ‡ãƒãƒƒã‚°ã¨ä¿®æ­£
2. â³ Phase 1ã®çµ±åˆãƒ†ã‚¹ãƒˆ
3. â³ Phase 2ï¼ˆè¤‡é›‘ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰ã®å®Ÿè£…
4. â³ Phase 3ï¼ˆè§’æ‹¬å¼§ç§‘ç›®åï¼‰ã®å®Œå…¨å®Ÿè£…
5. â³ æœ€çµ‚çµ±åˆãƒ†ã‚¹ãƒˆ

---

**ä½œæˆæ—¥**: 2025å¹´10æœˆ27æ—¥  
**ãƒ•ã‚¡ã‚¤ãƒ«**: `/Users/fukushima/Documents/xml_anken/gyosei-xml/scripts/education_script/reports/å®Ÿè£…é€²æ—ãƒ¬ãƒãƒ¼ãƒˆ_Phase1_é€”ä¸­çµŒé.md`

