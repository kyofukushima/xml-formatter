# 実装計画書

## 概要

本ドキュメントは、XML変換パイプライン処理システムのWebアプリケーション（Streamlitベース）の実装計画をまとめます。

---

## 実装フェーズ

### Phase 1: 基本機能の実装

**目標**: 基本的なXML変換パイプライン処理をWebアプリとして提供

**期間**: 2-3週間

#### Phase 1.1: プロジェクトセットアップ（1日）

- [ ] 開発環境のセットアップ
- [ ] プロジェクト構造の作成
- [ ] 必要なライブラリのインストール
- [ ] 基本的なStreamlitアプリの作成
- [ ] 設定ファイルの作成

**成果物**:
- `app.py`（基本的な構造）
- `requirements.txt`
- `.streamlit/config.toml`
- `utils/`ディレクトリ構造

#### Phase 1.2: 基本機能の実装（1週間）

**FR-001: XMLファイルのアップロード**
- [ ] ファイルアップロードUIの実装
- [ ] ファイル検証（拡張子、サイズ）
- [ ] ファイル情報の表示

**FR-002: 変換スクリプトの選択**
- [ ] スクリプト一覧の表示
- [ ] スクリプト選択UI（multiselect）
- [ ] スクリプト説明の表示

**FR-003: パイプライン処理の実行**
- [ ] `utils/pipeline.py`の実装
- [ ] パイプライン実行ロジック
- [ ] エラーハンドリング

**FR-004: 処理済みXMLファイルのダウンロード**
- [ ] ダウンロードボタンの実装
- [ ] ファイル名の生成

**FR-005: 処理進捗の表示**
- [ ] 進捗バーの実装
- [ ] ステップ情報の表示

**FR-006: エラーメッセージの表示**
- [ ] エラーメッセージの表示
- [ ] エラー詳細の表示

**成果物**:
- `app.py`（基本機能実装）
- `utils/pipeline.py`
- `utils/file_handler.py`

#### Phase 1.3: 検証機能の実装（3日）

**FR-007: 構文検証の実行**
- [ ] `utils/validation.py`の実装
- [ ] 構文検証の実行
- [ ] 検証結果の表示

**FR-008: テキスト内容検証の実行**
- [ ] テキスト内容検証の実装
- [ ] 検証結果の表示

**FR-009: 検証レポートの表示**
- [ ] 検証レポートの表示UI
- [ ] レポートのダウンロード（オプション）

**成果物**:
- `utils/validation.py`

#### Phase 1.4: ラベル設定機能の実装（1週間）

**FR-029: ブーリアン型パラメーターの簡易設定**（最優先）
- [ ] `utils/config_manager.py`の実装
- [ ] ブーリアン型パラメーターの読み込み
- [ ] チェックボックスUIの実装
- [ ] 設定の保存機能

**FR-023: ラベル設定の表示**
- [ ] ラベル設定の読み込み
- [ ] 設定内容の表示UI
- [ ] セクション分け表示

**FR-027: ラベル設定のバリデーション**
- [ ] JSONスキーマバリデーションの実装
- [ ] カスタムバリデーションの実装
- [ ] エラーメッセージの表示

**FR-025: ラベル設定の保存**
- [ ] 設定保存機能の実装
- [ ] バックアップ機能

**FR-026: ラベル設定のインポート/エクスポート**
- [ ] エクスポート機能の実装
- [ ] インポート機能の実装
- [ ] バリデーション統合

**FR-024: ラベル設定の編集**
- [ ] JSONエディタの統合
- [ ] 編集UIの実装
- [ ] 保存機能の統合

**成果物**:
- `utils/config_manager.py`
- `utils/validation.py`（拡張）
- `pages/02_⚙️_設定.py`（オプション）

#### Phase 1.5: オプション機能の実装（2日）

**FR-010: XMLファイルのプレビュー**
- [ ] XMLプレビューUIの実装
- [ ] シンタックスハイライト

**FR-011: 中間ファイルのダウンロード**
- [ ] 中間ファイル一覧の表示
- [ ] ダウンロード機能の実装

**成果物**:
- `components/xml_preview.py`（オプション）

#### Phase 1.6: テスト・デバッグ（2日）

- [ ] 単体テストの作成
- [ ] 統合テストの実行
- [ ] バグ修正
- [ ] ドキュメントの更新

**成果物**:
- `tests/`ディレクトリ
- テストレポート

---

## 実装タスク一覧

### 優先度: 高（必須）

| タスクID | 機能ID | タスク名 | 見積もり | 担当 |
|---------|--------|---------|---------|------|
| T-001 | FR-001 | XMLファイルのアップロード | 0.5日 | - |
| T-002 | FR-002 | 変換スクリプトの選択 | 0.5日 | - |
| T-003 | FR-003 | パイプライン処理の実行 | 2日 | - |
| T-004 | FR-004 | 処理済みXMLファイルのダウンロード | 0.5日 | - |
| T-005 | FR-005 | 処理進捗の表示 | 1日 | - |
| T-006 | FR-006 | エラーメッセージの表示 | 1日 | - |
| T-007 | FR-007 | 構文検証の実行 | 1日 | - |
| T-008 | FR-008 | テキスト内容検証の実行 | 1日 | - |
| T-009 | FR-009 | 検証レポートの表示 | 1日 | - |
| T-010 | FR-029 | ブーリアン型パラメーターの簡易設定 | 1日 | - |
| T-011 | FR-023 | ラベル設定の表示 | 1日 | - |
| T-012 | FR-027 | ラベル設定のバリデーション | 1日 | - |
| T-013 | FR-025 | ラベル設定の保存 | 0.5日 | - |
| T-014 | FR-026 | ラベル設定のインポート/エクスポート | 1日 | - |
| T-015 | FR-024 | ラベル設定の編集 | 2日 | - |

### 優先度: 中（推奨）

| タスクID | 機能ID | タスク名 | 見積もり | 担当 |
|---------|--------|---------|---------|------|
| T-016 | FR-010 | XMLファイルのプレビュー | 1日 | - |
| T-017 | FR-011 | 中間ファイルのダウンロード | 1日 | - |

---

## 実装スケジュール

### 週次スケジュール

**第1週**
- 月曜日: プロジェクトセットアップ（Phase 1.1）
- 火曜日〜金曜日: 基本機能の実装（Phase 1.2）

**第2週**
- 月曜日〜水曜日: 検証機能の実装（Phase 1.3）
- 木曜日〜金曜日: ラベル設定機能の実装開始（Phase 1.4）

**第3週**
- 月曜日〜水曜日: ラベル設定機能の実装完了（Phase 1.4）
- 木曜日〜金曜日: オプション機能・テスト・デバッグ（Phase 1.5, 1.6）

---

## リスク管理

### リスク一覧

| リスクID | リスク内容 | 影響度 | 発生確率 | 対策 |
|---------|-----------|--------|---------|------|
| R-001 | 既存スクリプトとの統合に問題が発生 | 高 | 中 | 既存スクリプトの動作確認を事前に実施 |
| R-002 | パフォーマンスの問題 | 中 | 中 | キャッシュ機能の実装、非同期処理の検討 |
| R-003 | 設定ファイルの読み込みエラー | 中 | 低 | エラーハンドリングの徹底、デフォルト設定の準備 |
| R-004 | ライブラリの互換性問題 | 低 | 低 | バージョンを固定、テスト環境での確認 |

---

## 成果物

### コード

- `app.py`: メインアプリケーション
- `utils/`: ユーティリティ関数群
- `pages/`: マルチページアプリ（オプション）
- `components/`: 再利用可能なコンポーネント（オプション）

### ドキュメント

- `README.md`: プロジェクト説明（更新）
- `docs/development_setup_guide.md`: 開発環境セットアップガイド
- `docs/development_guide.md`: 開発ガイド
- `docs/implementation_plan.md`: 実装計画書（本ドキュメント）

### テスト

- `tests/`: テストファイル群
- テストレポート

---

## 次のステップ

1. **開発環境のセットアップ**: [`development_setup_guide.md`](development_setup_guide.md)を参照
2. **実装の開始**: [`development_guide.md`](development_guide.md)を参照
3. **機能要件の確認**: [`../functional_requirements_specification.md`](../functional_requirements_specification.md)を参照
4. **実装例の確認**: [`../web_app_implementation_examples.md`](../web_app_implementation_examples.md)を参照

---

**最終更新**: 2025年1月

