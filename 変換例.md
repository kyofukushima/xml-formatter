# Sentence要素の次にカラムなしリストが複数続く場合の処理例

## ケース1: ColumnありListから変換されたItemの後（List要素のまま追加）

### 変換前
```xml
<Paragraph Num="1">
  <ParagraphNum>1</ParagraphNum>
  <ParagraphSentence>
    <Sentence Num="1">Paragraphの内容</Sentence>
  </ParagraphSentence>
  <List>
    <ListSentence>
      <Column Num="1">
        <Sentence Num="1">（１）</Sentence>
      </Column>
      <Column Num="2">
        <Sentence Num="1">項目の内容</Sentence>
      </Column>
    </ListSentence>
  </List>
  <List>
    <ListSentence>
      <Sentence Num="1">カラムなしリスト1</Sentence>
    </ListSentence>
  </List>
  <List>
    <ListSentence>
      <Sentence Num="1">カラムなしリスト2</Sentence>
    </ListSentence>
  </List>
  <List>
    <ListSentence>
      <Sentence Num="1">カラムなしリスト3</Sentence>
    </ListSentence>
  </List>
</Paragraph>
```

### 変換後
```xml
<Paragraph Num="1">
  <ParagraphNum>1</ParagraphNum>
  <ParagraphSentence>
    <Sentence Num="1">Paragraphの内容</Sentence>
  </ParagraphSentence>
  <Item Num="1">
    <ItemTitle>（１）</ItemTitle>
    <ItemSentence>
      <Sentence Num="1">項目の内容</Sentence>
    </ItemSentence>
    <!-- ColumnありListから変換されたItemの後なので、List要素のまま追加 -->
    <List>
      <ListSentence>
        <Sentence Num="1">カラムなしリスト1</Sentence>
      </ListSentence>
    </List>
    <List>
      <ListSentence>
        <Sentence Num="1">カラムなしリスト2</Sentence>
      </ListSentence>
    </List>
    <List>
      <ListSentence>
        <Sentence Num="1">カラムなしリスト3</Sentence>
      </ListSentence>
    </List>
  </Item>
</Paragraph>
```

**処理**: `is_column_list_converted_item`が`True`のため、カラムなしリストは**List要素のまま追加**されます。

---

## ケース2: no_column_textタイプのItemの後（List要素のまま追加）

### 変換前
```xml
<Paragraph Num="1">
  <ParagraphNum>1</ParagraphNum>
  <ParagraphSentence>
    <Sentence Num="1">Paragraphの内容</Sentence>
  </ParagraphSentence>
  <List>
    <ListSentence>
      <Sentence Num="1">最初のカラムなしリスト</Sentence>
    </ListSentence>
  </List>
  <List>
    <ListSentence>
      <Sentence Num="1">2つ目のカラムなしリスト</Sentence>
    </ListSentence>
  </List>
  <List>
    <ListSentence>
      <Sentence Num="1">3つ目のカラムなしリスト</Sentence>
    </ListSentence>
  </List>
</Paragraph>
```

### 変換後
```xml
<Paragraph Num="1">
  <ParagraphNum>1</ParagraphNum>
  <ParagraphSentence>
    <Sentence Num="1">Paragraphの内容</Sentence>
  </ParagraphSentence>
  <Item Num="1">
    <ItemTitle/>
    <ItemSentence>
      <Sentence Num="1">最初のカラムなしリスト</Sentence>
    </ItemSentence>
    <!-- no_column_textタイプ同士は取り込まれるため、List要素のまま追加 -->
    <List>
      <ListSentence>
        <Sentence Num="1">2つ目のカラムなしリスト</Sentence>
      </ListSentence>
    </List>
    <List>
      <ListSentence>
        <Sentence Num="1">3つ目のカラムなしリスト</Sentence>
      </ListSentence>
    </List>
  </Item>
</Paragraph>
```

**処理**: `is_no_column_text_item`が`True`のため、カラムなしリストは**List要素のまま追加**されます。

---

## ケース3: text_first_columnタイプのItemの後（List要素のまま追加）

### 変換前
```xml
<Paragraph Num="1">
  <ParagraphNum>1</ParagraphNum>
  <ParagraphSentence>
    <Sentence Num="1">Paragraphの内容</Sentence>
  </ParagraphSentence>
  <List>
    <ListSentence>
      <Column Num="1">
        <Sentence Num="1">テキスト（ラベルではない）</Sentence>
      </Column>
      <Column Num="2">
        <Sentence Num="1">内容1</Sentence>
      </Column>
      <Column Num="3">
        <Sentence Num="1">内容2</Sentence>
      </Column>
    </ListSentence>
  </List>
  <List>
    <ListSentence>
      <Sentence Num="1">カラムなしリスト1</Sentence>
    </ListSentence>
  </List>
  <List>
    <ListSentence>
      <Sentence Num="1">カラムなしリスト2</Sentence>
    </ListSentence>
  </List>
</Paragraph>
```

### 変換後
```xml
<Paragraph Num="1">
  <ParagraphNum>1</ParagraphNum>
  <ParagraphSentence>
    <Sentence Num="1">Paragraphの内容</Sentence>
  </ParagraphSentence>
  <Item Num="1">
    <ItemTitle/>
    <ItemSentence>
      <Sentence Num="1">テキスト（ラベルではない）</Sentence>
      <Sentence Num="2">内容1</Sentence>
      <Sentence Num="3">内容2</Sentence>
    </ItemSentence>
    <!-- text_first_columnタイプの場合、後続のColumnなしListを全て取り込む -->
    <List>
      <ListSentence>
        <Sentence Num="1">カラムなしリスト1</Sentence>
      </ListSentence>
    </List>
    <List>
      <ListSentence>
        <Sentence Num="1">カラムなしリスト2</Sentence>
      </ListSentence>
    </List>
  </Item>
</Paragraph>
```

**処理**: `is_text_first_column_item`が`True`のため、カラムなしリストは**List要素のまま追加**されます。

---

## ケース4: その他の場合（Sentence要素として追加）

### 変換前
```xml
<Paragraph Num="1">
  <ParagraphNum>1</ParagraphNum>
  <ParagraphSentence>
    <Sentence Num="1">Paragraphの内容</Sentence>
  </ParagraphSentence>
  <!-- 何らかの特殊なItem要素（上記のいずれのタイプでもない） -->
  <Item Num="1">
    <ItemTitle/>
    <ItemSentence>
      <Sentence Num="1">既存のSentence</Sentence>
    </ItemSentence>
  </Item>
  <List>
    <ListSentence>
      <Sentence Num="1">カラムなしリスト1</Sentence>
    </ListSentence>
  </List>
  <List>
    <ListSentence>
      <Sentence Num="1">カラムなしリスト2</Sentence>
    </ListSentence>
  </List>
  <List>
    <ListSentence>
      <Sentence Num="1">カラムなしリスト3</Sentence>
    </ListSentence>
  </List>
</Paragraph>
```

### 変換後
```xml
<Paragraph Num="1">
  <ParagraphNum>1</ParagraphNum>
  <ParagraphSentence>
    <Sentence Num="1">Paragraphの内容</Sentence>
  </ParagraphSentence>
  <Item Num="1">
    <ItemTitle/>
    <ItemSentence>
      <Sentence Num="1">既存のSentence</Sentence>
      <!-- 新しいSentence要素として追加（Num属性が順番に増加） -->
      <Sentence Num="2">カラムなしリスト1</Sentence>
      <Sentence Num="3">カラムなしリスト2</Sentence>
      <Sentence Num="4">カラムなしリスト3</Sentence>
    </ItemSentence>
  </Item>
</Paragraph>
```

**処理**: `is_column_list_converted_item`、`is_bracket_item`、`is_no_column_text_item`、`is_text_first_column_item`のいずれでもない場合、カラムなしリストの内容が**新しいSentence要素として追加**されます。複数のカラムなしリストが続く場合、それぞれが順番にNum属性が増加するSentence要素として追加されます。

---

## 処理の流れまとめ

1. **ColumnありListから変換されたItem** → List要素のまま追加
2. **括弧付き見出し系から変換されたItem** → List要素のまま追加
3. **no_column_textタイプのItem** → List要素のまま追加
4. **text_first_columnタイプのItem** → List要素のまま追加
5. **その他の場合** → Sentence要素として追加（Num属性が順番に増加）
